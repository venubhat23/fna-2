<div class="page-header">
  <h1>Order Analytics</h1>
</div>

<div class="row">
  <div class="col-md-2">
    <div class="card">
      <div class="card-body">
        <h5 class="card-title">Total Orders</h5>
        <h2><%= @total_orders %></h2>
      </div>
    </div>
  </div>

  <div class="col-md-2">
    <div class="card">
      <div class="card-body">
        <h5 class="card-title">Pending</h5>
        <h2 class="text-warning"><%= @pending_orders %></h2>
      </div>
    </div>
  </div>

  <div class="col-md-3">
    <div class="card">
      <div class="card-body">
        <h5 class="card-title">Processing</h5>
        <h2 class="text-info"><%= @processing_orders %></h2>
      </div>
    </div>
  </div>

  <div class="col-md-3">
    <div class="card">
      <div class="card-body">
        <h5 class="card-title">Completed</h5>
        <h2 class="text-success"><%= @completed_orders %></h2>
      </div>
    </div>
  </div>

  <div class="col-md-2">
    <div class="card">
      <div class="card-body">
        <h5 class="card-title">Cancelled</h5>
        <h2 class="text-danger"><%= @cancelled_orders %></h2>
      </div>
    </div>
  </div>
</div>

<div class="row mt-4">
  <div class="col-md-6">
    <div class="card">
      <div class="card-header">
        <h5>Orders by Status</h5>
      </div>
      <div class="card-body">
        <% if @orders_by_status.any? %>
          <table class="table">
            <thead>
              <tr>
                <th>Status</th>
                <th>Count</th>
              </tr>
            </thead>
            <tbody>
              <% @orders_by_status.each do |status, count| %>
                <tr>
                  <td>
                    <span class="badge badge-<%= status == 'completed' ? 'success' : status == 'pending' ? 'warning' : status == 'cancelled' ? 'danger' : 'info' %>">
                      <%= status&.humanize || 'Unknown' %>
                    </span>
                  </td>
                  <td><%= count %></td>
                </tr>
              <% end %>
            </tbody>
          </table>
        <% else %>
          <p>No order data available.</p>
        <% end %>
      </div>
    </div>
  </div>

  <div class="col-md-6">
    <div class="card">
      <div class="card-header">
        <h5>Recent Orders</h5>
      </div>
      <div class="card-body">
        <% if @recent_orders.any? %>
          <table class="table table-sm">
            <thead>
              <tr>
                <th>Order #</th>
                <th>Customer</th>
                <th>Amount</th>
                <th>Status</th>
              </tr>
            </thead>
            <tbody>
              <% @recent_orders.first(10).each do |order| %>
                <tr>
                  <td><%= order.try(:order_number) || order.try(:booking_number) || "##{order.id}" %></td>
                  <td><%= order.customer&.display_name || order.customer_name || 'N/A' %></td>
                  <td>â‚¹<%= number_with_delimiter(order.total_amount || 0, delimiter: ',') %></td>
                  <td>
                    <span class="badge badge-<%= order.status == 'completed' || order.status == 'delivered' ? 'success' : order.status == 'pending' ? 'warning' : order.status == 'cancelled' ? 'danger' : 'info' %>">
                      <%= order.status&.humanize || 'Unknown' %>
                    </span>
                  </td>
                </tr>
              <% end %>
            </tbody>
          </table>
        <% else %>
          <p>No recent orders.</p>
        <% end %>
      </div>
    </div>
  </div>
</div>