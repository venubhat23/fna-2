<div style="background: white; padding: 20px; margin: 20px;">
  <h1>Leads Test Page</h1>

  <div class="alert alert-info">
    <strong>Debug Info:</strong><br>
    Total Leads in DB: <%= @total_leads %><br>
    Filtered Leads Count: <%= @leads.count %><br>
    Current Time: <%= Time.current %><br>
    User: <%= current_user&.email %><br>
  </div>

  <h2>Pipeline Statistics</h2>
  <div style="background: #f8f9fa; padding: 15px; margin: 10px 0;">
    <p>Consultation: <%= @consultation_leads %></p>
    <p>One-on-One: <%= @one_on_one_leads %></p>
    <p>Converted: <%= @converted_leads %></p>
    <p>Policy Created: <%= @policy_created_leads %></p>
    <p>Referral Settled: <%= @referral_settled_leads %></p>
  </div>

  <h2>Leads List</h2>
  <% if @leads.any? %>
    <div style="background: #e8f5e8; padding: 15px; margin: 10px 0;">
      <p><strong>Found <%= @leads.count %> leads:</strong></p>
      <table border="1" style="width: 100%; border-collapse: collapse;">
        <thead>
          <tr style="background: #ddd;">
            <th style="padding: 10px;">ID</th>
            <th style="padding: 10px;">Name</th>
            <th style="padding: 10px;">Email</th>
            <th style="padding: 10px;">Stage</th>
            <th style="padding: 10px;">Product</th>
          </tr>
        </thead>
        <tbody>
          <% @leads.limit(10).each do |lead| %>
            <tr>
              <td style="padding: 10px;"><%= lead.id %></td>
              <td style="padding: 10px;"><%= lead.name %></td>
              <td style="padding: 10px;"><%= lead.email %></td>
              <td style="padding: 10px;"><%= lead.current_stage %></td>
              <td style="padding: 10px;"><%= lead.product_interest %></td>
            </tr>
          <% end %>
          <% if @leads.count > 10 %>
            <tr>
              <td colspan="5" style="padding: 10px; text-align: center;">
                ... and <%= @leads.count - 10 %> more leads
              </td>
            </tr>
          <% end %>
        </tbody>
      </table>
    </div>
  <% else %>
    <div style="background: #f8d7da; padding: 15px; margin: 10px 0;">
      <p><strong>No leads found!</strong></p>
      <p>This might indicate a filtering issue or database problem.</p>
    </div>
  <% end %>

  <div style="margin-top: 30px;">
    <%= link_to "Back to Original Leads", admin_leads_path, class: "btn btn-primary" %>
    <%= link_to "Add New Lead", new_admin_lead_path, class: "btn btn-success" %>
  </div>
</div>

<style>
.btn {
  display: inline-block;
  padding: 8px 16px;
  margin: 4px;
  text-decoration: none;
  background: #007bff;
  color: white;
  border-radius: 4px;
}

.btn-success {
  background: #28a745;
}
</style>