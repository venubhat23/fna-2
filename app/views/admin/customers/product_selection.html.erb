<!-- Page Header -->
<div class="d-flex justify-content-between align-items-center mb-4">
  <div>
    <h2 class="mb-1">Select Product for <%= @customer.display_name %></h2>
    <p class="text-muted mb-0">Choose a product to create for this customer</p>
  </div>
  <div class="d-flex gap-2">
    <%= link_to admin_customer_path(@customer), class: "btn btn-outline-info" do %>
      <i class="bi bi-eye me-1"></i>
      View Customer
    <% end %>
    <%= link_to admin_customers_path, class: "btn btn-outline-secondary" do %>
      <i class="bi bi-arrow-left me-1"></i>
      Back to Customers
    <% end %>
  </div>
</div>

<!-- Success Notice -->
<% if notice %>
  <div class="alert alert-success alert-dismissible fade show" role="alert">
    <div class="d-flex align-items-center">
      <i class="bi bi-check-circle-fill me-2"></i>
      <div><%= notice %></div>
    </div>
    <button type="button" class="btn-close" data-bs-dismiss="alert" aria-label="Close"></button>
  </div>
<% end %>

<!-- Customer Summary Card -->
<div class="card border-0 shadow-sm mb-4">
  <div class="card-body">
    <div class="row align-items-center">
      <div class="col-md-2">
        <% if @customer.profile_image.attached? %>
          <%= image_tag @customer.profile_image, class: "rounded-circle", style: "width: 80px; height: 80px; object-fit: cover;" %>
        <% else %>
          <div class="bg-primary bg-opacity-10 rounded-circle d-flex align-items-center justify-content-center" style="width: 80px; height: 80px;">
            <i class="bi bi-person text-primary" style="font-size: 2rem;"></i>
          </div>
        <% end %>
      </div>
      <div class="col-md-6">
        <h5 class="mb-1"><%= @customer.display_name %></h5>
        <p class="text-muted mb-1">
          <i class="bi bi-person-badge me-1"></i>
          <%= @customer.customer_type&.humanize || 'General' %> Customer
        </p>
        <p class="text-muted mb-0">
          <i class="bi bi-telephone me-1"></i>
          <%= @customer.mobile %>
          <% if @customer.email.present? %>
            | <i class="bi bi-envelope ms-2 me-1"></i>
            <%= @customer.email %>
          <% end %>
        </p>
      </div>
      <div class="col-md-4 text-md-end">
        <span class="badge bg-success-subtle text-success px-3 py-2">
          <i class="bi bi-check-circle me-1"></i>
          Customer Created Successfully
        </span>
      </div>
    </div>
  </div>
</div>

<!-- Product Selection Grid -->
<div class="row g-4">
  <% @products.each do |product| %>
    <div class="col-lg-4 col-md-6">
      <div class="card border-0 shadow-sm h-100 product-card">
        <div class="card-body text-center p-4">
          <div class="product-icon mb-3">
            <i class="bi bi-<%= product[:icon] %>" style="font-size: 3rem; color: #0d6efd;"></i>
          </div>
          <h5 class="card-title mb-2"><%= product[:name] %></h5>
          <p class="card-text text-muted mb-4"><%= product[:description] %></p>

          <% if product[:path] != '#' %>
            <%= link_to product[:path], class: "btn btn-primary btn-lg w-100" do %>
              <i class="bi bi-plus-circle me-2"></i>
              Create <%= product[:name] %>
            <% end %>
          <% else %>
            <button class="btn btn-outline-secondary btn-lg w-100" disabled>
              <i class="bi bi-clock me-2"></i>
              Coming Soon
            </button>
          <% end %>
        </div>
      </div>
    </div>
  <% end %>
</div>

<!-- Skip Option -->
<div class="text-center mt-5">
  <p class="text-muted mb-3">Not ready to add a product right now?</p>
  <%= link_to admin_customer_path(@customer), class: "btn btn-outline-secondary" do %>
    <i class="bi bi-arrow-right me-1"></i>
    Skip for Now - View Customer Profile
  <% end %>
</div>

<style>
.product-card {
  transition: transform 0.2s ease-in-out, box-shadow 0.2s ease-in-out;
}

.product-card:hover {
  transform: translateY(-5px);
  box-shadow: 0 0.5rem 1rem rgba(0, 0, 0, 0.15) !important;
}

.product-icon {
  transition: transform 0.2s ease-in-out;
}

.product-card:hover .product-icon {
  transform: scale(1.1);
}
</style>