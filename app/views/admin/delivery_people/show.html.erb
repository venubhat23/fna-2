<!-- Page Header -->
<div class="d-flex justify-content-between align-items-center mb-4">
  <div>
    <h2 class="mb-1"><%= @delivery_person.display_name %></h2>
    <nav aria-label="breadcrumb">
      <ol class="breadcrumb mb-0">
        <li class="breadcrumb-item"><%= link_to "Dashboard", dashboard_path, class: "text-decoration-none" %></li>
        <li class="breadcrumb-item"><%= link_to "Delivery People", admin_delivery_people_path, class: "text-decoration-none" %></li>
        <li class="breadcrumb-item active" aria-current="page"><%= @delivery_person.display_name %></li>
      </ol>
    </nav>
  </div>
  <div class="d-flex gap-2">
    <%= link_to edit_admin_delivery_person_path(@delivery_person), class: "btn btn-warning" do %>
      <i class="bi bi-pencil me-1"></i>
      Edit
    <% end %>
    <%= link_to toggle_status_admin_delivery_person_path(@delivery_person),
        method: :patch,
        class: "btn btn-outline-#{@delivery_person.status? ? 'secondary' : 'success'}",
        data: {
          confirm: "Are you sure you want to #{@delivery_person.status? ? 'deactivate' : 'activate'} this delivery person?",
          turbo_method: :patch
        } do %>
      <i class="bi bi-#{@delivery_person.status? ? 'pause-circle' : 'play-circle'} me-1"></i>
      <%= @delivery_person.status? ? 'Deactivate' : 'Activate' %>
    <% end %>
    <%= link_to admin_delivery_people_path, class: "btn btn-outline-secondary" do %>
      <i class="bi bi-arrow-left me-1"></i>
      Back to List
    <% end %>
  </div>
</div>

<!-- Status Badge -->
<div class="row mb-4">
  <div class="col-12">
    <div class="d-flex align-items-center gap-3">
      <span class="badge bg-<%= @delivery_person.status_badge_class %> fs-6 px-3 py-2">
        <i class="bi bi-<%= @delivery_person.status? ? 'check-circle' : 'x-circle' %> me-1"></i>
        <%= @delivery_person.status_text %>
      </span>
      <span class="text-muted">
        <i class="bi bi-calendar me-1"></i>
        <%= @delivery_person.years_of_service %> year<%= @delivery_person.years_of_service != 1 ? 's' : '' %> of service
      </span>
    </div>
  </div>
</div>

<!-- Main Content -->
<div class="row g-4">
  <!-- Left Column -->
  <div class="col-lg-8">
    <!-- Personal Details -->
    <div class="card border-0 shadow-sm mb-4">
      <div class="card-header bg-transparent border-0 pb-0">
        <div class="d-flex align-items-center">
          <div class="bg-primary bg-opacity-10 rounded p-2 me-3">
            <i class="bi bi-person text-primary"></i>
          </div>
          <h5 class="card-title mb-0">Personal Details</h5>
        </div>
      </div>
      <div class="card-body pt-3">
        <div class="row g-3">
          <div class="col-md-6">
            <div class="d-flex align-items-center mb-3">
              <i class="bi bi-person-fill text-muted me-2"></i>
              <div>
                <small class="text-muted d-block">Full Name</small>
                <span class="fw-medium"><%= @delivery_person.full_name %></span>
              </div>
            </div>
          </div>
          <div class="col-md-6">
            <div class="d-flex align-items-center mb-3">
              <i class="bi bi-envelope text-muted me-2"></i>
              <div>
                <small class="text-muted d-block">Email</small>
                <span class="fw-medium"><%= @delivery_person.email %></span>
              </div>
            </div>
          </div>
          <div class="col-md-6">
            <div class="d-flex align-items-center mb-3">
              <i class="bi bi-telephone text-muted me-2"></i>
              <div>
                <small class="text-muted d-block">Mobile</small>
                <span class="fw-medium"><%= @delivery_person.mobile %></span>
              </div>
            </div>
          </div>
          <div class="col-md-6">
            <div class="d-flex align-items-center mb-3">
              <i class="bi bi-calendar-event text-muted me-2"></i>
              <div>
                <small class="text-muted d-block">Joining Date</small>
                <span class="fw-medium"><%= @delivery_person.joining_date&.strftime('%d %b %Y') %></span>
              </div>
            </div>
          </div>
          <div class="col-12">
            <div class="d-flex align-items-start">
              <i class="bi bi-geo-alt text-muted me-2 mt-1"></i>
              <div>
                <small class="text-muted d-block">Address</small>
                <span class="fw-medium">
                  <%= @delivery_person.address %><br>
                  <%= @delivery_person.city %>, <%= @delivery_person.state %> - <%= @delivery_person.pincode %>
                </span>
              </div>
            </div>
          </div>
        </div>
      </div>
    </div>

    <!-- Vehicle Details -->
    <div class="card border-0 shadow-sm mb-4">
      <div class="card-header bg-transparent border-0 pb-0">
        <div class="d-flex align-items-center">
          <div class="bg-info bg-opacity-10 rounded p-2 me-3">
            <i class="bi bi-truck text-info"></i>
          </div>
          <h5 class="card-title mb-0">Vehicle Details</h5>
        </div>
      </div>
      <div class="card-body pt-3">
        <div class="row g-3">
          <div class="col-md-4">
            <div class="d-flex align-items-center mb-3">
              <i class="bi bi-truck text-muted me-2"></i>
              <div>
                <small class="text-muted d-block">Vehicle Type</small>
                <span class="badge bg-info"><%= @delivery_person.vehicle_type&.humanize || 'N/A' %></span>
              </div>
            </div>
          </div>
          <div class="col-md-4">
            <div class="d-flex align-items-center mb-3">
              <i class="bi bi-car-front text-muted me-2"></i>
              <div>
                <small class="text-muted d-block">Vehicle Number</small>
                <span class="fw-medium"><%= @delivery_person.vehicle_number %></span>
              </div>
            </div>
          </div>
          <div class="col-md-4">
            <div class="d-flex align-items-center mb-3">
              <i class="bi bi-card-text text-muted me-2"></i>
              <div>
                <small class="text-muted d-block">License Number</small>
                <span class="fw-medium"><%= @delivery_person.license_number %></span>
              </div>
            </div>
          </div>
        </div>
      </div>
    </div>

    <!-- Emergency Contact -->
    <div class="card border-0 shadow-sm mb-4">
      <div class="card-header bg-transparent border-0 pb-0">
        <div class="d-flex align-items-center">
          <div class="bg-warning bg-opacity-10 rounded p-2 me-3">
            <i class="bi bi-exclamation-triangle text-warning"></i>
          </div>
          <h5 class="card-title mb-0">Emergency Contact</h5>
        </div>
      </div>
      <div class="card-body pt-3">
        <div class="row g-3">
          <div class="col-md-6">
            <div class="d-flex align-items-center mb-3">
              <i class="bi bi-person-exclamation text-muted me-2"></i>
              <div>
                <small class="text-muted d-block">Contact Name</small>
                <span class="fw-medium"><%= @delivery_person.emergency_contact_name %></span>
              </div>
            </div>
          </div>
          <div class="col-md-6">
            <div class="d-flex align-items-center mb-3">
              <i class="bi bi-telephone-plus text-muted me-2"></i>
              <div>
                <small class="text-muted d-block">Contact Mobile</small>
                <span class="fw-medium"><%= @delivery_person.emergency_contact_mobile %></span>
              </div>
            </div>
          </div>
        </div>
      </div>
    </div>

    <!-- Bank Details -->
    <% if @delivery_person.bank_name.present? || @delivery_person.account_no.present? %>
      <div class="card border-0 shadow-sm mb-4">
        <div class="card-header bg-transparent border-0 pb-0">
          <div class="d-flex align-items-center">
            <div class="bg-secondary bg-opacity-10 rounded p-2 me-3">
              <i class="bi bi-bank text-secondary"></i>
            </div>
            <h5 class="card-title mb-0">Bank Details</h5>
          </div>
        </div>
        <div class="card-body pt-3">
          <div class="row g-3">
            <div class="col-md-6">
              <div class="d-flex align-items-center mb-3">
                <i class="bi bi-bank text-muted me-2"></i>
                <div>
                  <small class="text-muted d-block">Bank Name</small>
                  <span class="fw-medium"><%= @delivery_person.bank_name || 'Not provided' %></span>
                </div>
              </div>
            </div>
            <div class="col-md-6">
              <div class="d-flex align-items-center mb-3">
                <i class="bi bi-person-check text-muted me-2"></i>
                <div>
                  <small class="text-muted d-block">Account Holder</small>
                  <span class="fw-medium"><%= @delivery_person.account_holder_name || 'Not provided' %></span>
                </div>
              </div>
            </div>
            <div class="col-md-6">
              <div class="d-flex align-items-center mb-3">
                <i class="bi bi-hash text-muted me-2"></i>
                <div>
                  <small class="text-muted d-block">Account Number</small>
                  <span class="fw-medium">
                    <%= @delivery_person.account_no.present? ? "*" * (@delivery_person.account_no.length - 4) + @delivery_person.account_no.last(4) : 'Not provided' %>
                  </span>
                </div>
              </div>
            </div>
            <div class="col-md-6">
              <div class="d-flex align-items-center mb-3">
                <i class="bi bi-upc text-muted me-2"></i>
                <div>
                  <small class="text-muted d-block">IFSC Code</small>
                  <span class="fw-medium"><%= @delivery_person.ifsc_code || 'Not provided' %></span>
                </div>
              </div>
            </div>
          </div>
        </div>
      </div>
    <% end %>

    <!-- Additional Notes -->
    <% if @delivery_person.notes.present? %>
      <div class="card border-0 shadow-sm">
        <div class="card-header bg-transparent border-0 pb-0">
          <div class="d-flex align-items-center">
            <div class="bg-info bg-opacity-10 rounded p-2 me-3">
              <i class="bi bi-sticky text-info"></i>
            </div>
            <h5 class="card-title mb-0">Additional Notes</h5>
          </div>
        </div>
        <div class="card-body pt-3">
          <p class="mb-0"><%= simple_format(@delivery_person.notes) %></p>
        </div>
      </div>
    <% end %>
  </div>

  <!-- Right Column -->
  <div class="col-lg-4">
    <!-- Profile Picture -->
    <div class="card border-0 shadow-sm mb-4">
      <div class="card-body text-center">
        <% if @delivery_person.profile_picture.attached? %>
          <%= image_tag @delivery_person.profile_picture, class: "rounded-circle shadow mb-3", style: "width: 150px; height: 150px; object-fit: cover;" %>
        <% else %>
          <div class="bg-light rounded-circle d-flex align-items-center justify-content-center mx-auto mb-3" style="width: 150px; height: 150px;">
            <i class="bi bi-person text-muted" style="font-size: 4rem;"></i>
          </div>
        <% end %>
        <h5 class="mb-1"><%= @delivery_person.display_name %></h5>
        <p class="text-muted mb-0"><%= @delivery_person.vehicle_info %></p>
      </div>
    </div>

    <!-- Employment Summary -->
    <div class="card border-0 shadow-sm mb-4">
      <div class="card-header bg-transparent border-0 pb-0">
        <div class="d-flex align-items-center">
          <div class="bg-success bg-opacity-10 rounded p-2 me-3">
            <i class="bi bi-currency-rupee text-success"></i>
          </div>
          <h5 class="card-title mb-0">Employment Summary</h5>
        </div>
      </div>
      <div class="card-body pt-3">
        <div class="mb-3">
          <div class="d-flex justify-content-between align-items-center mb-2">
            <small class="text-muted">Monthly Salary</small>
            <span class="fw-bold text-success fs-5"><%= @delivery_person.formatted_salary %></span>
          </div>
        </div>

        <div class="mb-3">
          <div class="d-flex justify-content-between align-items-center mb-2">
            <small class="text-muted">Years of Service</small>
            <span class="fw-medium"><%= @delivery_person.years_of_service %> year<%= @delivery_person.years_of_service != 1 ? 's' : '' %></span>
          </div>
        </div>

        <div class="mb-0">
          <div class="d-flex justify-content-between align-items-center">
            <small class="text-muted">Current Status</small>
            <span class="badge bg-<%= @delivery_person.status_badge_class %>">
              <%= @delivery_person.status_text %>
            </span>
          </div>
        </div>
      </div>
    </div>

    <!-- Delivery Areas -->
    <% if @delivery_person.delivery_areas.present? %>
      <div class="card border-0 shadow-sm mb-4">
        <div class="card-header bg-transparent border-0 pb-0">
          <div class="d-flex align-items-center">
            <div class="bg-info bg-opacity-10 rounded p-2 me-3">
              <i class="bi bi-geo text-info"></i>
            </div>
            <h5 class="card-title mb-0">Delivery Areas</h5>
          </div>
        </div>
        <div class="card-body pt-3">
          <div class="d-flex flex-wrap gap-2">
            <% @delivery_person.delivery_area_list.each do |area| %>
              <span class="badge bg-light text-dark border"><%= area %></span>
            <% end %>
          </div>
        </div>
      </div>
    <% end %>

    <!-- Documents -->
    <div class="card border-0 shadow-sm">
      <div class="card-header bg-transparent border-0 pb-0">
        <div class="d-flex align-items-center">
          <div class="bg-primary bg-opacity-10 rounded p-2 me-3">
            <i class="bi bi-file-earmark-text text-primary"></i>
          </div>
          <h5 class="card-title mb-0">Documents</h5>
        </div>
      </div>
      <div class="card-body pt-3">
        <div class="row g-2">
          <div class="col-12">
            <div class="d-flex align-items-center justify-content-between p-2 rounded border">
              <div class="d-flex align-items-center">
                <i class="bi bi-file-earmark-person text-primary me-2"></i>
                <span class="small">License Document</span>
              </div>
              <% if @delivery_person.license_document.attached? %>
                <span class="badge bg-success">
                  <i class="bi bi-check-circle me-1"></i>Available
                </span>
              <% else %>
                <span class="badge bg-secondary">Not uploaded</span>
              <% end %>
            </div>
          </div>
          <div class="col-12">
            <div class="d-flex align-items-center justify-content-between p-2 rounded border">
              <div class="d-flex align-items-center">
                <i class="bi bi-file-earmark-arrow-up text-info me-2"></i>
                <span class="small">Vehicle Document</span>
              </div>
              <% if @delivery_person.vehicle_document.attached? %>
                <span class="badge bg-success">
                  <i class="bi bi-check-circle me-1"></i>Available
                </span>
              <% else %>
                <span class="badge bg-secondary">Not uploaded</span>
              <% end %>
            </div>
          </div>
        </div>
      </div>
    </div>
  </div>
</div>